# セキュリティガイドライン

このドキュメントでは、Slack-to-Bookmarkプロジェクトを使用する際の操作者の環境情報を保護するためのガイドラインを提供します。プロジェクトを安全に使用し、機密情報の漏洩を防止するために、以下のガイドラインに従うことをお勧めします。

## 目次

1. [環境変数の管理](#環境変数の管理)
2. [生成されるデータの取り扱い](#生成されるデータの取り扱い)
3. [プロジェクトの共有](#プロジェクトの共有)
4. [セキュリティチェックの実行](#セキュリティチェックの実行)
5. [Git使用時の注意点](#git使用時の注意点)
6. [画面共有とデモンストレーション時の注意点](#画面共有とデモンストレーション時の注意点)

## 環境変数の管理

環境変数は、APIトークンやワークスペース情報など、機密性の高い情報を格納するために使用されます。

### 推奨事項:

- **`.env`ファイルの保護**: `.env`ファイルには実際のAPIトークンや組織情報が含まれています。このファイルは:
  - バージョン管理から除外する（デフォルトで`.gitignore`に設定済み）
  - 共有されたリポジトリやクラウドストレージに保存しない
  - バックアップを取る場合は暗号化する

- **環境変数の値**:
  - APIトークンを頻繁にローテーション（定期的に更新）する
  - 必要最小限の権限を持つトークンを使用する
  - 実際の本番環境トークンをテスト環境で使用しない

- **サンプルファイル**:
  - `.env.sample`にはプレースホルダーとダミー値のみを使用する
  - 実際の環境変数の値やパターンを`.env.sample`に含めない
  - コメントを使って各環境変数の目的と形式を説明する

## 生成されるデータの取り扱い

このプロジェクトは、Slackワークスペースの情報を含むHTMLファイルを生成します。これらのファイルには組織の内部情報が含まれている可能性があります。

### 推奨事項:

- **生成ファイルの保護**:
  - 生成されたHTMLファイルはバージョン管理システムにコミットしない
  - HTMLファイルは安全な場所に保存し、必要に応じてのみ共有する
  - 使用後は不要なHTMLファイルを削除する

- **ユーザー情報の保護**:
  - 特に`slack_user_dms.html`には組織の全メンバーリストが含まれることに注意する
  - 組織外部へのユーザーリストの漏洩を防止する

- **チャンネル情報の保護**:
  - プライベートチャンネルの存在自体が機密情報となる場合がある
  - 特に`slack_bookmarks.html`にはプライベートチャンネルの情報が含まれることに注意する

## プロジェクトの共有

このプロジェクトを他者と共有する際には、意図せず機密情報を漏洩するリスクがあります。

### 推奨事項:

- **コード共有前のチェック**:
  - コードを共有する前に必ず`security_check.py`を実行する
  - 共有する前に各ファイルを手動で確認し、機密情報が含まれていないことを確認する

- **公開リポジトリへのプッシュ**:
  - 公開リポジトリにプッシュする前に、pre-commitフックが正しく設定されていることを確認する
  - 一度公開されたコミット履歴から機密情報を完全に削除することは非常に困難であることを認識する

- **コード共有プラットフォーム**:
  - GitHubやGitLabなどのプラットフォームでプロジェクトを共有する際は、セキュリティスキャンツールを活用する
  - コード共有サービスで提供されるSecret Scanningなどの機能を有効にする

## セキュリティチェックの実行

プロジェクトには、潜在的なセキュリティリスクを検出するための`security_check.py`スクリプトが含まれています。

### 使用方法:

```bash
# スクリプトに実行権限を付与する（初回のみ）
chmod +x security_check.py

# セキュリティチェックを実行
./security_check.py
```

### 定期的なチェック:

以下のタイミングでセキュリティチェックを実行することをお勧めします:

- コードを他者と共有する前
- 変更をコミットする前
- プロジェクトを公開リポジトリにプッシュする前
- 新しい機能を追加した後
- 別のプロジェクトからコードをインポートした後

## Git使用時の注意点

Gitを使用する際には、機密情報が誤ってコミットされるリスクがあります。

### 推奨事項:

- **pre-commitフックの使用**:
  - プロジェクトに含まれるpre-commitフックを有効にする:
    ```bash
    chmod +x .git/hooks/pre-commit
    ```
  - 独自のpre-commitフックを追加する場合は、既存のセキュリティチェックを維持する

- **コミット前の確認**:
  - `git diff --staged`を使用して、コミットされる変更を確認する
  - 大量の変更をコミットする前に、小さな単位に分割してレビューしやすくする

- **機密情報の誤コミット時の対応**:
  - 機密情報を誤ってコミットした場合は、以下の手順で対応する:
    1. 機密情報を含むコミットを特定する
    2. `git filter-branch`や`BFG Repo Cleaner`などのツールを使用して履歴から削除する
    3. 影響を受ける可能性のあるシステムでトークンやパスワードをリセットする
    4. 強制プッシュ（`git push --force`）で履歴を上書きする（共有リポジトリの場合は注意が必要）

## 画面共有とデモンストレーション時の注意点

画面共有やデモンストレーションセッション中に、意図せず機密情報が漏洩するリスクがあります。

### 推奨事項:

- **画面キャプチャ時**:
  - キャプチャ画像に`.env`ファイルや機密情報が表示されていないことを確認する
  - 画像を公開する前に、画像内の機密情報をぼかしたり黒塗りしたりする
  - IDE内のファイルタブやディレクトリ構造に機密情報が表示されていないか確認する

- **画面共有中**:
  - 共有セッション前に、機密情報を含むファイルを閉じる
  - 可能であれば、共有する画面を特定のアプリケーションウィンドウに限定する
  - 通知バナーや他のアプリケーションからの機密情報漏洩に注意する

- **ビデオ会議やストリーミング**:
  - ライブセッション中に機密情報を表示しないよう注意する
  - 録画されたセッションを公開する前に、機密情報が含まれていないか確認する

## まとめ

セキュリティは継続的なプロセスです。このガイドラインに従うことで、Slack-to-Bookmarkプロジェクトを使用する際のセキュリティリスクを大幅に軽減できます。何か不明な点や懸念事項がある場合は、プロジェクトメンテナーに連絡してください。

セキュリティに関する懸念事項がある場合は、問題が解決するまでプロジェクトの共有や公開を延期することをお勧めします。機密情報の漏洩は、一度発生すると取り返しがつかない場合があります。
